<view class="wrap">
  <!-- iOSé£æ ¼çš„æ“ä½œæ  -->
  <view class="ios-action-bar">
    <view class="ios-status-bar"></view>
    <view class="ios-action-content">
      <view class="spacer"></view>
      <view class="ios-add-button" bindtap="onAdd">
        <text class="ios-icon">+</text>
      </view>
    </view>
  </view>

  <!-- çºªå¿µæ—¥åˆ—è¡¨ -->
  <view class="anniversary-list">
    <view class="anniversary-card" wx:for="{{list}}" wx:key="id" data-event-index="{{item}}" bindtap="onUpdate">
      <view wx:if="{{item.canEdit}}" class="ios-delete-button" data-event-index="{{item}}" catchtap="onDelete">
        <text class="ios-delete-icon">Ã—</text>
      </view>
      <view class="anniversary-content">
        <view class="anniversary-title">{{item.name}}</view>
        <view class="anniversary-date">{{item.date}}</view>
        <view class="anniversary-days"><text>{{item.days}}</text> å¤©</view>
        <!-- å›¾ç‰‡å›¾æ ‡ï¼Œåªæœ‰å½“æœ‰å›¾ç‰‡æ—¶æ‰æ˜¾ç¤º -->
        <view class="anniversary-images-icon" wx:if="{{item.images && item.images.length > 0}}" catchtap="viewImages" data-event-index="{{item}}">
          <text class="images-count">{{item.images.length}}</text>
          <text class="images-icon">ğŸ“·</text>
        </view>
      </view>
    </view>
  </view>

  <!-- iOSé£æ ¼çš„å¼¹å‡ºå¯¹è¯æ¡† -->
  <view wx:if="{{dialog}}" aria-role="dialog" aria-modal="true">
    <view class="weui-mask weui-transition {{dialog ? 'weui-transition_show' : ''}}" bindtap="closeDialog" aria-role="button" aria-label="å…³é—­"></view>
    <view class="weui-half-screen-dialog weui-half-screen-dialog_large weui-transition {{dialog ? 'weui-transition_show' : ''}}">
      <view class="weui-half-screen-dialog__hd">
        <view class="weui-half-screen-dialog__hd__side" bindtap="closeDialog">
          <view class="ios-close-btn">
            <text class="ios-close-icon">Ã—</text>
          </view>
        </view>
        <view class="weui-half-screen-dialog__hd__main">
          <strong class="weui-half-screen-dialog__title">åˆ›å»ºçºªå¿µæ—¥</strong>
        </view>
      </view>
      <view class="weui-half-screen-dialog__bd">
        <view class="ios-form-group">
          <view class="ios-form-item">
            <input class="ios-input" value="{{name}}" placeholder-class="ios-input-placeholder" bindinput="bindInputChange" placeholder="è¿™æ˜¯æˆ‘ä»¬çš„ä»€ä¹ˆçºªå¿µæ—¥" />
          </view>
          <view class="ios-form-item">
            <picker mode="date" class="date-picker" aria-role="combobox" aria-labelledby="js_date" value="{{date}}" start="2016-09-01" bindchange="bindDateChange">
              <view class="ios-input date-picker-text">{{date}}</view>
            </picker>
          </view>
        </view>
        
        <!-- å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ -->
        <view class="ios-form-group">
          <view class="ios-form-item">
            <view class="image-upload-title">çºªå¿µæ—¥ç…§ç‰‡</view>
          </view>
          
          <!-- å›¾ç‰‡é¢„è§ˆåŒºåŸŸ -->
          <view class="ios-form-item" wx:if="{{tempImages.length > 0 || uploadedImages.length > 0}}">
            <view class="image-preview-area">
              <!-- æ˜¾ç¤ºä¸´æ—¶é€‰æ‹©çš„å›¾ç‰‡ -->
              <view class="image-preview-item" wx:for="{{tempImages}}" wx:key="index">
                <image class="preview-image" src="{{item.tempFilePath}}" mode="aspectFill" bindtap="previewImage" data-index="{{index}}"></image>
                <view class="delete-image-btn" catchtap="deleteImage" data-index="{{index}}">
                  <text class="delete-icon">Ã—</text>
                </view>
              </view>
              
              <!-- æ˜¾ç¤ºå·²ä¸Šä¼ çš„å›¾ç‰‡ -->
              <view class="image-preview-item" wx:for="{{uploadedImages}}" wx:key="index">
                <image class="preview-image" src="{{item.fileID}}" mode="aspectFill" bindtap="previewUploadedImage" data-index="{{index}}"></image>
                <view class="delete-image-btn" catchtap="deleteUploadedImage" data-index="{{index}}">
                  <text class="delete-icon">Ã—</text>
                </view>
              </view>
            </view>
          </view>
          
          <!-- å›¾ç‰‡ä¸Šä¼ æŒ‰é’® -->
          <view class="ios-form-item">
            <view class="image-upload-btn" bindtap="chooseImages">
              <text class="upload-icon">+</text>
              <text class="upload-text">æ·»åŠ ç…§ç‰‡</text>
            </view>
            <view class="image-tip">æœ€å¤šå¯ä»¥é€‰æ‹©9å¼ å›¾ç‰‡</view>
          </view>
        </view>
      </view>
      <view class="weui-half-screen-dialog__ft">
        <view class="ios-button ios-button-primary" bindtap="onSave">ä¿å­˜</view>
      </view>
    </view>
  </view>
</view>