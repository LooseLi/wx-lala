<view class="container">
  <view class="header">
    <view class="year-selector">
      <view class="year-btn {{activeYear === currentYear ? 'active' : ''}}" bindtap="switchYear" data-year="{{currentYear}}">
        {{currentYear}}å¹´
      </view>
      <view class="year-btn {{activeYear === nextYear ? 'active' : ''}}" bindtap="switchYear" data-year="{{nextYear}}">
        {{nextYear}}å¹´
      </view>
    </view>
  </view>

  <view class="month-navigator">
    <view class="nav-btn" bindtap="prevMonth">
      <text class="nav-icon">ã€ˆ</text>
    </view>
    <view class="current-month">{{months[currentIndex].year}}å¹´{{months[currentIndex].monthName}}</view>
    <view class="nav-btn" bindtap="nextMonth">
      <text class="nav-icon">ã€‰</text>
    </view>
    <view class="today-btn {{isCurrentMonthActive ? 'disabled' : ''}}" bindtap="goToToday">è¿”å›ä»Šå¤©</view>
  </view>

  <view class="weekday-header">
    <view class="weekday-item" wx:for="{{weekdays}}" wx:key="*this">{{item}}</view>
  </view>

  <swiper class="calendar-swiper" current="{{currentIndex}}" bindchange="handleSwiperChange" circular="{{true}}" duration="200" skip-hidden-item-layout="{{true}}">
    <swiper-item wx:for="{{months}}" wx:key="id" wx:for-item="month" wx:for-index="monthIndex">
      <view class="calendar-grid">
        <view class="calendar-row" wx:for="{{month.rows}}" wx:for-item="row" wx:for-index="rowIndex" wx:key="rowIndex">
          <view class="calendar-cell {{item.currentMonth ? '' : 'other-month'}} {{item.isToday ? 'today' : ''}} {{item.isSelected ? 'selected' : ''}} {{item.isHoliday ? 'holiday' : ''}} {{item.isWorkday ? 'workday' : ''}} {{item.isFirstDay ? 'first-day' : ''}} {{item.isMiddleDay ? 'middle-day' : ''}} {{item.isLastDay ? 'last-day' : ''}}" wx:for="{{row}}" wx:key="date" bindtap="selectDate" data-date="{{item.date}}" data-month-index="{{monthIndex}}">
            <view class="date-text">{{item.day}}</view>
            <!-- å†œå†æ—¥æœŸ -->
            <view class="lunar-date {{item.isCustomFestival ? 'custom-festival' : ''}}" wx:if="{{item.lunar}}">{{item.lunar.display || item.lunar.day}}</view>
            <!-- å‡æœŸæ ‡è®° -->
            <view class="holiday-tag" wx:if="{{item.isHoliday}}">ä¼‘</view>
            <!-- è°ƒä¼‘æ ‡è®° -->
            <view class="workday-tag" wx:if="{{item.isWorkday}}">ç­</view>
          </view>
        </view>
      </view>
    </swiper-item>
  </swiper>

  <view class="selected-date-info" wx:if="{{selectedDateInfo}}">
    <view class="date-header">
      <text class="selected-date">{{selectedDateInfo.month}}æœˆ{{selectedDateInfo.day}}æ—¥ {{selectedDateInfo.weekday}}</text>
      <text class="lunar-info" wx:if="{{selectedDateInfo.lunar}}">å†œå† {{selectedDateInfo.lunar.month}}{{selectedDateInfo.lunar.day}}</text>
    </view>
    <view class="festival-details" wx:if="{{selectedDateInfo.customFestival}}">
      <view wx:if="{{selectedDateInfo.customFestival.tips}}">
        <view class="festival-name">{{selectedDateInfo.customFestival.name}}</view>
        <view class="festival-tips">
          {{selectedDateInfo.customFestival.tips}}
        </view>
      </view>
      <view class="holiday-details" wx:elif="{{selectedDateInfo.isHoliday || selectedDateInfo.isWorkday}}">
        <view class="holiday-name">{{selectedDateInfo.holidayName}}</view>
        <view class="holiday-type {{selectedDateInfo.isHoliday ? 'holiday-type' : 'workday-type'}}">
          {{selectedDateInfo.isHoliday ? 'æ”¾å‡å¿«ä¹ğŸ˜†' : 'è°ƒä¼‘ä¸Šç­ğŸ¥¹'}}
        </view>
      </view>
      <view class="no-holiday" wx:else>
        <text>è¿™ä¸€å¤©æ²¡æœ‰ç‰¹æ®Šå®‰æ’</text>
      </view>
    </view>
    <view class="holiday-details" wx:elif="{{selectedDateInfo.isHoliday || selectedDateInfo.isWorkday}}">
      <view class="holiday-name">{{selectedDateInfo.holidayName}}</view>
      <view class="holiday-type {{selectedDateInfo.isHoliday ? 'holiday-type' : 'workday-type'}}">
        {{selectedDateInfo.isHoliday ? 'æ”¾å‡å¿«ä¹ğŸ˜†' : 'è°ƒä¼‘ä¸Šç­ğŸ¥¹'}}
      </view>
    </view>
    <view class="no-holiday" wx:else>
      <text>è¿™ä¸€å¤©æ²¡æœ‰ç‰¹æ®Šå®‰æ’</text>
    </view>
  </view>

  <view class="footer">
    <view class="tips">æ³•å®šèŠ‚å‡æ—¥å®‰æ’å¯èƒ½ä¼šæœ‰è°ƒæ•´ï¼Œè¯·ä»¥å›½åŠ¡é™¢å‘å¸ƒçš„é€šçŸ¥ä¸ºå‡†</view>
  </view>
</view>